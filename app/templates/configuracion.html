<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Configuración de Cuenta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Importa la fuente Oswald de Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/configuracion.css') }}">
  <link rel="icon" type="image/png" href="https://i.postimg.cc/26ZkKCPm/Vector.png">
</head>


<body>
  
  {% include 'nav.html' %}
  {% include 'errors.html' %}
  
  <div class="container">

    <div class="card2 header">
      <h1 class="titulo-principal">Configuración de cuenta</h1>
    </div>

    <div class="card info">
      <p><strong>Nombre de usuario:</strong> <span class="highlight">{{ primer_nombre }} {{ primer_apellido }} </span></p>
      <p id="fecha_registro">{{ fecha_registro }}</p>
      <p><strong>Rol actual:</strong> <span class="highlight">{{ rol }}</span></p>
    </div>

    <div class="card">
      <div class="flex-between">
        <p>¿Necesitas cambiar tu contraseña? Hazlo en segundos.</p>
        <button type="button" id="cambiarContraseñaBtn" class="btn-primary">Cambiar contraseña</button>
      </div>
    </div>

    <div id="formularioCambio" class="card hidden">
      <h2 class="titulo-secundario">Cambiar contraseña</h2>
      <form id="passwordForm" action="{{ url_for('web.cambiar_contraseña') }}" method="POST">
        <!-- Solo pedimos nueva y confirmar porque la lógica actual no usa la actual -->
       <label>Actual contraseña</label>
        <div class="password-wrapper">
            <input id="pass1" type="password" name="actual_contrasena" required>
            <i class="bi bi-eye-fill toggle-pass" data-target="pass1"></i>
        </div>

      <label>Nueva contraseña</label>
      <div class="password-wrapper">
          <input id="pass2" type="password" name="nueva_contrasena" required>
          <i class="bi bi-eye-fill toggle-pass" data-target="pass2"></i>
      </div>

              <!-- Mensaje de error para requisitos -->
        <div id="password-req-error" style="color: red; font-size: 13px; margin-left: 10px; display: none;"></div>

        <!-- Lista de requisitos -->
        <div id="password-requirements" style="font-size: 12px; color: #666; margin-left: 10px; margin-top: 5px;">
          <p><span id="req-length"><i class="bi bi-x-circle text-danger"></i></span> Al menos 6 caracteres</p>
          <p><span id="req-uppercase"><i class="bi bi-x-circle text-danger"></i></span> Al menos 1 letra mayúscula</p>
        </div>

      <label>Repetir nueva contraseña</label>
      <div class="password-wrapper">
          <input id="pass3" type="password" name="confirmar_contrasena" required>
          <i class="bi bi-eye-fill toggle-pass" data-target="pass3"></i>
      </div>

       <!-- Mensaje de coincidencia -->
        <div id="password-match"></div>
        <div id="password-error" style="display: none;"></div>


        <div class="flex">
          <button type="submit" class="btn-primary">Guardar cambios</button>
          <button type="button" id="cancelarBtn" class="btn-secondary">Cancelar</button>
        </div>
      </form>
    </div>

    <div class="card">
      <div class="flex-between">
        <p>Esta opción hace que tu cuenta quede en estado de deshabilitación de manera definitiva.</p>
        <button type="button" id="eliminarCuentaBtn" class="btn-primary">Eliminar cuenta</button>
      </div>
    </div>

    <div id="formularioEliminar" class="card hidden">
      <h2 class="titulo-secundario">Eliminar cuenta</h2>
      <form id="eliminarForm" action="{{ url_for('web.deshabilitar_cuenta') }}" method="POST">
        <div id="little-text">
          <p>Esta acción es permanente y no se puede deshacer.</p>
          <p>No podrás iniciar sesión ni acceder a tu perfil.</p>
          <p>Tu perfil y tus servicios dejarán de ser visibles para los usuarios.</p>
          <p>Importante: La desactivación no elimina tus datos; tu cuenta quedará registrada pero deshabilitada.</p>
        </div>
        <label>Ingresar contraseña</label>
        <div class="password-wrapper">
          <input id="pass4" type="password" name="contrasena" required>
          <i class="bi bi-eye-fill toggle-pass" data-target="pass4"></i>
        </div>
        <p id="mensajeErrorEliminar" class="error-text"></p>



        <div class="flex">
         <button type="button" id="btnEliminarCuentaForm" class="btn-primary">Eliminar</button>
          <button type="button" id="cancelarEliminarBtn" class="btn-secondary">Cancelar</button>
        </div>
      </form>
    </div>

  </div>

<!-- Modal eliminar cuenta -->
<div id="modalEliminarCuenta" class="modal-eliminar-cuenta hidden">
  <div class="modal-eliminar-content">
    <h2>Nos entristece que quieras irte</h2>
    <p>Esta acción es permanente y no podrás recuperar tu información, publicaciones ni contactos. </p>
    <p>¿Estás seguro de que deseas eliminar tu cuenta?</p>
    <div class="modal-eliminar-buttons">
      <button type="button" id="confirmarEliminarBtn" class="btn-eliminar-confirm">Eliminar</button>
      <button id="cancelarEliminarModalBtn" class="btn-eliminar-cancel">Cancelar</button>
    </div>
  </div>
</div>


  
<script src="{{ url_for('static', filename='js/configuracion.js') }}"></script>
<script src="{{ url_for('static', filename='js/ocultar_contraseña.js') }}"></script>
<!-- Modificación Camilo: Incluí el footer correctamente antes de </body>. -->
{% include 'footer.html' %}
</body>
</html>
